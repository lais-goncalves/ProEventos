<div>
<!--	<p>{{form.value | json}}</p>-->
	<form [formGroup]="this.form">
		<div class="card rounded shadow-sm">
			<div class="p-3">
				<div class="row mb-3">
					<div class="form-group col-md-12">
						<label>Tema</label>
						<input
							type="text"
							class="form-control"
							formControlName="tema"
							placeholder="Insira o Tema"
							[ngClass]="this.validarCampoEventos('tema')"
						>
						@if (f.tema?.errors?.required) {
							<div class="invalid-feedback">Tema é obrigatório.</div>
						}

						@else if (f.tema?.errors?.minlength) {
							<div class="invalid-feedback">Deve ter no mínimo 4 caracteres.</div>
						}

						@else if (f.tema?.errors?.maxlength) {
							<div class="invalid-feedback">Deve ter no máximo 50 caracteres.</div>
						}
					</div>
				</div>
				<div class="row mb-3">
					<div class="form-group col-md-8">
						<label>Local</label>
						<input
							type="text"
							class="form-control"
							formControlName="local"
							placeholder=""
							[ngClass]="this.validarCampoEventos('local')"
						>
						<div class="invalid-feedback">Local é obrigatório.</div>
					</div>
					<div class="form-group col-md-4">
						<label>Data e Hora</label>
						<input
							type="datetime-local"
							class="form-control"
							formControlName="dataEvento"
							placeholder=""
							[ngClass]="this.validarCampoEventos('dataEvento')"
						>
						<div class="invalid-feedback">Data e hora são obrigatórios.</div>
					</div>
				</div>
				<div class="row mb-3">
					<div class="form-group col-md-2">
						<label>Qtd Pessoas</label>
						<input
							type="number"
							step="50"
							class="form-control"
							formControlName="qtdPessoas"
							placeholder=""
							[ngClass]="this.validarCampoEventos('qtdPessoas')"
						>
						@if (f.qtdPessoas?.errors?.required) {
							<div class="invalid-feedback">Qtd Pessoas é obrigatório.</div>
						}

						@else if (f.qtdPessoas?.errors?.max) {
							<div class="invalid-feedback">Qtd máxima deve ser 120000.</div>
						}
					</div>
					<div class="form-group col-md-2">
						<label>Telefone</label>
						<input
							type="text"
							class="form-control"
							formControlName="telefone"
							placeholder="(000) 90000-0000"
							[ngClass]="this.validarCampoEventos('telefone')"
						>
						<div class="invalid-feedback">Telefone é obrigatório.</div>
					</div>
					<div class="form-group col-md-5">
						<label>E-mail</label>
						<input
							type="text"
							class="form-control"
							formControlName="email" placeholder="e-mail"
							[ngClass]="this.validarCampoEventos('email')"
						>
						@if (f.email?.errors?.required) {
							<div class="invalid-feedback">E-mail é obrigatório.</div>
						}

						@if (f.email?.errors?.email) {
							<div class="invalid-feedback">Deve ser um e-mail válido.</div>
						}
					</div>
					<div class="form-group col-md-3">
						<label>Imagem URL</label>
						<input
							type="text"
							class="form-control"
							formControlName="imagemURL"
							placeholder=""
							[ngClass]="this.validarCampoEventos('imagemURL')"
						>
						<div class="invalid-feedback">ImagemURL é obrigatório.</div>
					</div>
				</div>
			</div>
			<div class="card-footer">
				<div class="d-flex justify-content-between">
					<button class="btn btn-outline-secondary border" (click)="this.resetarCamposEvento()">
						Cancelar Alteração
					</button>
					<button class="btn btn-success" (click)="this.salvarAlteracoesEvento()" [disabled]="!this.form.valid">
	<!--					<span class="spinner-border spinner-border-sm me-1"></span>-->
						Salvar Evento
					</button>
				</div>
			</div>
		</div>

		@if (this.modoEditar) {
			<div class="card rounded shadow-sm mt-4">
				<div class="p-3">
					<div class="d-flex border-bottom">
						<h2 class="me-auto">
							Lotes do Evento
						</h2>
						<h2>
							<i class="fas fa-money-bill-wave"></i>
						</h2>
					</div>
					<p>Clique em Lote para adicionar e preencher novos Lotes</p>
					<div class="form-row p-1">
						<div class="col">
							<div formArrayName="lotes">
								@for (lote of lotes?.controls; track $index) {
									<fieldset [formGroupName]="$index" class="form-group py-3">
										<legend class="d-flex justify-content-between capitalize">
											<button class="p-2 align-items-center btn btn-sm btn-outline-warning mb-1 d-flex"
													tooltip="Excluir Lote"
													[adaptivePosition]="false"
													[delay]="500"
													placement="left"
													(click)="this.excluirLote(template, $index)"
											>
												<fa-icon [icon]="faWindowClose" class="my-1 me-1" />
												<b class="ml-1 d-none d-sm-block">Excluir</b>
											</button>
										</legend>
										<div class="row">
											<div class="form-group col-md-4">
												<label>Nome</label>
												<input
													type="text"
													class="form-control"
													formControlName="nome"
													placeholder="Lote"
													[ngClass]="this.validarCampoLotes($index, 'nome')"
												>
												<div class="invalid-feedback">Nome é obrigatório.</div>
											</div>
											<div class="form-group col-md-4">
												<label>Quantidade</label>
												<input
													type="text"
													class="form-control"
													formControlName="quantidade"
													placeholder="000"
													[ngClass]="this.validarCampoLotes($index, 'quantidade')"
												>
												<div class="invalid-feedback">Quantidade é obrigatório.</div>
											</div>
											<div class="form-group col-md-4">
												<label>Preço</label>
												<input
													type="text"
													currencyMask class="form-control"
													formControlName="preco"
													placeholder="R$ 0,00"
													[ngClass]="this.validarCampoLotes($index, 'preco')"
												>
												<div class="invalid-feedback">Preço é obrigatório.</div>
											</div>
											<div class="form-group col-md-4">
												<label>Data Início</label>
												<input
													type="datetime-local"
													class="form-control"
													formControlName="dataInicio"
													placeholder="01/01/2019"
													[ngClass]="this.validarCampoLotes($index, 'dataInicio')"
												>
												<div class="invalid-feedback">Data Início é obrigatório.</div>
											</div>
											<div class="form-group col-md-4">
												<label>Data Fim</label>
												<input
													type="datetime-local"
													class="form-control"
													formControlName="dataFim"
													placeholder="01/01/2019"
													[ngClass]="this.validarCampoLotes($index, 'dataFim')"
												>
												<div class="invalid-feedback">Data Fim é obrigatório.</div>
											</div>
										</div>
									</fieldset>
								}
							</div>
						</div>
					</div>
					<button class="d-flex align-items-center btn btn-outline-primary" (click)="this.adicionarLote()">
						<fa-icon [icon]="faPlusCircle" class="my-1 me-1" />
						<b class="ml-1">Lote</b>
					</button>
				</div>
				<div class="card-footer">
					<div class="d-flex">
						<button class="btn btn-outline-secondary me-auto border">
							Cancelar Alteração
						</button>
						<button class="btn btn-success" (click)="this.salvarAlteracoesLotes()">
							Salvar Lotes
						</button>
					</div>
				</div>
			</div>
		}
	</form>
</div>

<br />

<ng-template #template>
	<div class="modal-body text-center">
		<p>Deletar lote #{{this.loteId}}?</p>
		<button type="button" class="btn btn-outline-danger" (click)="confirmarDeletarLote()" >Sim</button>
		<button type="button" class="btn" (click)="cancelarDeletarLote()" >Não</button>
	</div>
</ng-template>
