<div class="card rounded shadow-sm p-3">
	<div class="d-flex align-items-center mb-2">
		<div class="flex-fill input-group">
			<div class="input-group-prepend">
				<div class="input-group-text">
					<label for="txtFiltro" class="px-0">Filtro:</label>
				</div>
			</div>

			<input
				id="txtFiltro"
				class="form-control"
				name="txtFiltro"
				type="text"
				placeholder="Filtrar por tema e local"
				[(ngModel)]="filtro"
			>
		</div>

		<div>
			<a routerLink="/eventos/detalhe" class="d-flex align-items-center btn btn-outline-primary">
				<fa-icon [icon]="faPlusCircle" />
				<b class="ml-1 d-none d-sm-block">Novo</b>
			</a>
		</div>
	</div>

	<table class="table table-striped table-hover">
		<thead class="table-dark">
		<tr>
			<th>#</th>
			<th class="d-none d-md-table-cell">
				<button
					class="btn btn-primary"
					(click)="alterarImagens()"
				>
					@if (this.mostrarImagens) {
						<fa-icon [icon]="this.faEye" /> Mostrar
					}

					@else {
						<fa-icon [icon]="this.faEyeSlash" /> Ocultar
					}
				</button>
			</th>
			<th class="d-none d-md-table-cell">Tema</th>
			<th>Local</th>
			<th>Data</th>
			<th class="d-none d-md-table-cell">Qtd Pessoas</th>
			<th class="d-none d-md-table-cell">Lote</th>
			<th>Opções</th>
		</tr>
		</thead>

		@if (!!this.eventos && this.eventos.length > 0) {
			<tbody>
				@for (evento of this.eventosFiltrados; track evento.id) {
					<tr class="table-bordered" (click)="detalheEvento(evento.id)" style="cursor: pointer">
						<td>{{evento.id}}</td>
						<td class="d-none d-md-table-cell">
							<img
								src="assets/{{evento.imagemURL}}"
								alt=""
								[style.width.px]="largImagem"
								[style.margin.px]="margImagem"
								[collapse]="this.mostrarImagens"
								[isAnimated]="true"
							>
						</td>
						<td class="d-none d-md-table-cell" style="word-break: break-word">{{evento.tema}}</td>
						<td>{{evento.local}}</td>
						<td>{{(evento.dataEvento ?? 0) | dateTimeFormat}}</td>
						<td class="d-none d-md-table-cell">{{evento.qtdPessoas}}</td>
						<td class="d-none d-md-table-cell">
							<p>
							@for (lote of evento.lotes; track lote.id) {
								@if ($index !== evento.lotes.length - 1) {
									{{lote.id+", "}}
								}
								@else {
									{{lote.id}}
									}
							}
							</p>
						</td>
						<td>
							<div class="d-flex justify-content-center">
								<button class="btn btn-primary btn-sm mx-1 d-none d-md-block">
									<fa-icon [icon]="faPenToSquare"></fa-icon>
								</button>

								<button class="btn btn-danger btn-sm mx-1" (click)="this.openModal($event, template, evento.id)">
									<fa-icon [icon]="faTrash"></fa-icon>
								</button>
							</div>
						</td>
					</tr>
				}
			</tbody>
		}

		@else {
			<tfoot>
			<tr>
				<td colspan="8" class="py-4">
					<h4 class="text-center">Nenhum evento encontrado.</h4>
				</td>
			</tr>
			</tfoot>
		}
	</table>
</div>

<ng-template #template>
	<div class="modal-body text-center">
		<p>Deletar evento #{{this.eventoId}}?</p>
		<button type="button" class="btn btn-outline-danger" (click)="confirm()" >Sim</button>
		<button type="button" class="btn" (click)="decline()" >Não</button>
	</div>
</ng-template>
